{"schemas":"DEFINE TABLE OVERWRITE audit_log TYPE NORMAL SCHEMAFULL\n\tPERMISSIONS\n\t\tFOR select WHERE $auth.role = role:admin OR $auth.id = employee:admin\n\t\tFOR create FULL\n\t\tFOR update, delete NONE\n;\nDEFINE FIELD OVERWRITE action ON audit_log TYPE string\n\tASSERT $value IN [\n\t\t'login', 'logout', 'login_failed', 'token_refresh',\n\t\t'read', 'create', 'update', 'delete',\n\t\t'config_change', 'user_create', 'user_update', 'user_delete',\n\t\t'role_change', 'permission_change',\n\t\t'server_start', 'server_stop', 'backup_create', 'backup_restore',\n\t\t'unauthorized_access', 'invalid_token'\n\t]\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE resource ON audit_log TYPE string\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE success ON audit_log TYPE bool DEFAULT true\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE user_id ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE username ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE ip_address ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE user_agent ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE details ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE error ON audit_log TYPE option<string>\n\tPERMISSIONS FULL\n;\nDEFINE FIELD OVERWRITE created_at ON audit_log TYPE datetime VALUE time::now() READONLY\n\tPERMISSIONS FULL\n;\nDEFINE INDEX OVERWRITE audit_action_idx ON audit_log FIELDS action;\nDEFINE INDEX OVERWRITE audit_user_idx ON audit_log FIELDS user_id;\nDEFINE INDEX OVERWRITE audit_resource_idx ON audit_log FIELDS resource;\nDEFINE INDEX OVERWRITE audit_created_idx ON audit_log FIELDS created_at;\nDEFINE INDEX OVERWRITE audit_success_idx ON audit_log FIELDS success;\n","events":""}
